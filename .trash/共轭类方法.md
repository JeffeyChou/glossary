---
title: 共轭类方法
date: 2022-10-21 08:42:06
excerpt: 
tags: 最优化算法 共轭 共轭方向法 共轭梯度法
rating: ⭐
status: complete 
destination: 03-05 
share: false
obsidianUIMode: source
---
### 共轭方向法 
**方法特性：**
1. 对于n维二次型问题，能够在n步之内得到结果。
2. 共轭梯度法不需要计算黑塞矩阵
3. 不需要储存n·n矩阵，也不需要对矩阵进行求逆
4. 计算速度介于最速下降法和牛顿法之间。

**定义10.1(共轭)**：
$Q$ 为 $n \times n$ 的对称实矩阵, 对于方向 $\boldsymbol{d}^{(0)}, \boldsymbol{d}^{(1)}, \boldsymbol{d}^{(2)}, \cdots, \boldsymbol{d}^{(m)}$, 如果对 于所有的 $i \neq j$, 有 $\boldsymbol{d}^{(i)} \boldsymbol{Q} \boldsymbol{d}^{(j)}=0$, 则称它们是关于 $\boldsymbol{Q}$ 共轭的

**引理10.1**：
$Q$ 为 $n \times n$ 的对称正定矩阵, 如果方向 $\boldsymbol{d}^{(0)}, \boldsymbol{d}^{(1)}, \cdots, \boldsymbol{d}^{(k)} \in \mathbb{R}^n, k \leqslant n-$ 1 非零, 且是关于 $\boldsymbol{Q}$ 共轭的, 那么它们是线性无关的。

---
### 共轭方向算法
针对 $n$ 维二次型函数的最小化问题:
$$
f(\boldsymbol{x})=\frac{1}{2} \boldsymbol{x}^{\top} \boldsymbol{Q} \boldsymbol{x}-\boldsymbol{x}^{\top} \boldsymbol{b}
$$
其中, $\boldsymbol{Q}=\boldsymbol{Q}^{\top}>0, \boldsymbol{x} \in \mathbb{R}^n$ 。注意, 由于 $\boldsymbol{Q}>0$, 因此函数 $f$ 有一个全局极小点, 可通过求解 $Q x=b$ 得到。

**基本的共轭方向算法**
给定初始点 $\boldsymbol{x}^{(0)}$ 和一组关于 $\boldsymbol{Q}$ 共轭的方向 $\boldsymbol{d}^{(0)}, \boldsymbol{d}^{(1)}, \cdots$, $\boldsymbol{d}^{(n-1)}$ ，迭代公式为 $(k \geqslant 0$ 表示迭代次数)
$$
\begin{aligned}
\boldsymbol{g}^{(k)} &=\nabla f\left(\boldsymbol{x}^{(k)}\right)=\boldsymbol{Q} \boldsymbol{x}^{(k)}-\boldsymbol{b} \\
\alpha_k &=-\frac{\boldsymbol{g}^{(k) \top} \boldsymbol{d}^{(k)}}{\boldsymbol{d}^{(k) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}} \\
\boldsymbol{x}^{(k+1)} &=\boldsymbol{x}^{(k)}+\alpha_k \boldsymbol{d}^{(k)}
\end{aligned}
$$
**定理10.1**：
对于任意的初始点 $\boldsymbol{x} ^{(0)}$，基本的共轭方向算法都能在 $n$ 次迭代之内收敛到唯一的全局极小点 $\boldsymbol{x}^*$ ,即 $\boldsymbol{x}^{(n)}=\boldsymbol{x}^*$ 。

**引理10.2(精确步长)**：
在共轭方向算法中, 对于所有 $k, 0 \leqslant k \leqslant n-1,0 \leqslant i \leqslant k$, 都有
$$
\boldsymbol{g}^{(k+1) \top} \boldsymbol{d}^{(i)}=0
$$

---
### 共轭梯度法 
**特性**：
共轭方向法虽然计算效率高，但是需要提供一组 $Q$ 共轭方向，共轭梯度法不需要预先给定 $Q$ 共轭方向，而是随着迭代的进行不断产生 $Q$共轭方向。利用上一个搜索方向和目标函数在当前已经产生的搜索方向组成 $Q$ 共轭方向。

**计算步骤**:
1. 令 $k=0$; 选择初始值 $\boldsymbol{x}^{(0)}$ 。
2. 计算 $\boldsymbol{g}^{(0)}=\nabla f\left(\boldsymbol{x}^{(0)}\right)$, 如果 $\boldsymbol{g}^{(0)}=\mathbf{0}$, 停止迭代; 否则, 令 $\boldsymbol{d}^{(0)}=-\boldsymbol{g}^{(0)}$ 。
3. 计算 $\alpha_k=-\frac{\boldsymbol{g}^{(k) \top} \boldsymbol{d}^{(k)}}{\boldsymbol{d}^{(k) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}}$ 。
4. 计算 $\boldsymbol{x}^{(k+1)}=\boldsymbol{x}^{(k)}+\alpha_k \boldsymbol{d}^{(k)}$ 。
5. 计算 $\boldsymbol{g}^{(k+1)}=\nabla f\left(\boldsymbol{x}^{(k+1)}\right)$, 如果 $\boldsymbol{g}^{(k+1)}=\mathbf{0}$, 停止迭代。
6. 计算 $\beta_k=\frac{\boldsymbol{g}^{(k+1) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}}{\boldsymbol{d}^{(k) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}}$ 。
7. 计算 $\boldsymbol{d}^{(k+1)}=-\boldsymbol{g}^{(k+1)}+\beta_k \boldsymbol{d}^{(k)}$ 。
8. 令 $k:=k+1$, 回到第 3 步。

---
### 非线性共轭梯度法
对于一般的非线性函数而言，每次使用共轭梯度法进行迭代，都需要重新计算黑塞矩阵，需要进行非常大的计算量，所以需要对其进行修改，消除每次迭代中进行求黑塞矩阵的环节。

- **Hestenes-Stiefel公式**：
$$
\beta_k=\frac{\boldsymbol{g}^{(k+1) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}}{\boldsymbol{d}^{(k) \top} \boldsymbol{Q} \boldsymbol{d}^{(k)}}
$$
- **Polak-Ribiere公式**:
将 $Hestenes-Stiefel$ 公式的分母部分展开。
$$
\beta_k=\frac{\boldsymbol{g}^{(k+1) \top}\left[\boldsymbol{g}^{(k+1)}-\boldsymbol{g}^{(k)}\right]}{\boldsymbol{g}^{(k) \top} \boldsymbol{g}^{(k)}}
$$
- **Fletcher_reeves公式**：
将 $Polak-Ribiere$ 公式的分子部分展开。
$$
\beta_k=\frac{\boldsymbol{g}^{(k+1) \top}\boldsymbol{g}^{(k+1)}}{\boldsymbol{g}^{(k) \top} \boldsymbol{g}^{(k)}}
$$
对于二次型问题，这三个公式是等价的；但是。当目标函数为一般的非线性函数时，这三个公式并不一致。

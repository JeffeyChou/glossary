---
title: 等式约束的优化问题
date: 2022-11-09 11:30:52
excerpt: 
tags: 最优化算法 等式约束 拉格朗日乘数法
rating: ⭐
status: complete 
destination: 03-05 
share: false
obsidianUIMode: source
---
### 问题描述&相关定义
该部分所讨论的优化问题形如：$$
\begin{aligned}
minimize \quad &f(x) \\
subject \quad &h_i(x)=0,\quad i=1,\cdots,m \\
\end{aligned}
$$
> 若无特殊说明，本章的优化问题均是找到极小值点。

我们定义**可行集**为所有可行点组成的集合：$$
\left\{\boldsymbol{x} \in \mathbb{R}^n: \boldsymbol{h}_i(\boldsymbol{x})=\mathbf{0}\right\}
$$
我们定义**正则点**为满足以下形式的点：满足约束 $h_1\left(\boldsymbol{x}^*\right)=0, \cdots, h_m\left(\boldsymbol{x}^*\right)=0$ 的点 $\boldsymbol{x}^*$, 梯度向量 $\nabla h_1\left(\boldsymbol{x}^*\right), \cdots, \nabla h_m\left(\boldsymbol{x}^*\right)$ 是线性无关的。

我们定义**切线空间**： 曲面 $S=\left\{\boldsymbol{x} \in \mathbb{R}^n: h(\boldsymbol{x})=\mathbf{0}\right\}$ 中点 $\boldsymbol{x}^*$ 处的切线空间为集合 $T\left(\boldsymbol{x}^*\right)=$ $\left\{\boldsymbol{y}: \operatorname{Dh}\left(\boldsymbol{x}^*\right) \boldsymbol{y}=\mathbf{0}\right\}_{\text {。 }}$
可以看出，切线空间 $T\left(\boldsymbol{x}^*\right)$ 是矩阵 $D \boldsymbol{h}\left(\boldsymbol{x}^*\right)$ 的零空间:
$$
T\left(\boldsymbol{x}^*\right)=\mathcal{N}\left(D \boldsymbol{h}\left(\boldsymbol{x}^*\right)\right)
$$
我们定义**拉格朗日函数**：$l: \mathbb{R}^n \times \mathbb{R}^m \rightarrow \mathbb{R}$ 
$$
l(\boldsymbol{x}, \boldsymbol{\lambda}) \triangleq f(\boldsymbol{x})+\boldsymbol{\lambda}^{\top} \boldsymbol{h}(\boldsymbol{x})
$$

---

### 拉格朗日条件
#### 一阶必要条件
$$
\nabla f(\boldsymbol{x}^*)+\boldsymbol{\lambda}^{* \top} \nabla h(\boldsymbol{x}^*)=\mathbf{0}^{\top} 
$$
#### 二阶必要条件
对于所有 $\boldsymbol{y} \in T(\boldsymbol{x}^* )$ 都有:
$$
\boldsymbol{y}^{\top} \mathbf{L}(\boldsymbol{x}^*, \boldsymbol{\lambda}^*)\boldsymbol{y}  \ge 0
$$
其中 $\mathbf{L}(\boldsymbol{x}^*, \boldsymbol{\lambda}^*) = \mathbf{F}(\boldsymbol{x}^* )+\boldsymbol{\lambda}\mathbf{H}(\boldsymbol{x}^*)$ ，$\mathbf{F}(\boldsymbol{x}^* )$ 是 $f(x)$ 在 $\boldsymbol{x}^*$ 处的 $Hessian$ 矩阵；$\mathbf{H}(\boldsymbol{x}^* )$ 是 $\boldsymbol{h}_i(\boldsymbol{x})$ 在 $\boldsymbol{x}^*$ 处的 $Hessian$ 矩阵。即： 
$$
\boldsymbol{H}_i(\boldsymbol{x})=\left[\begin{array}{ccc}
\frac{\partial^2 h_i}{\partial x_1^2}(\boldsymbol{x}) & \cdots & \frac{\partial^2 h_i}{\partial x_n \partial x_1}(\boldsymbol{x}) \\
\vdots & & \vdots \\
\frac{\partial^2 h_i}{\partial x_1 \partial x_n}(\boldsymbol{x}) & \cdots & \frac{\partial^2 h_i}{\partial^2 x_n}(\boldsymbol{x})
\end{array}\right]
$$

#### 二阶充分条件
函数 $f, \boldsymbol{h} \in \mathcal{C}^2$, 如果存在点 $\boldsymbol{x}^* \in \mathbb{R}^n$ 和 $\boldsymbol{\lambda}^* \in \mathbb{R}^m$, 使得
1. $$\nabla\boldsymbol{f}\left(\boldsymbol{x}^*\right)+\boldsymbol{\lambda}^{* \top}\nabla \boldsymbol{h}\left(\boldsymbol{x}^*\right)=\mathbf{0}^{\top}$$
2. 对于所有 $\boldsymbol{y} \in T\left(\boldsymbol{x}^*\right)$$, \boldsymbol{y} \neq \mathbf{0}$, 都有 $$\boldsymbol{y}^{\top} \boldsymbol{L}\left(\boldsymbol{x}^*, \boldsymbol{\lambda}^*\right) \boldsymbol{y}>0$$
那么, $\boldsymbol{x}^*$ 是 $f$ 在约束条件 $\boldsymbol{h}(\boldsymbol{x})=\mathbf{0}$ 下的严格局部极小点。

---
### 参考资料
[^1]: Edwin K. P. Chong 等著，孙志强等译；《最优化导论 (第四版》2015.
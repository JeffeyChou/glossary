---
title: 含不等式约束的优化问题
date: 2022-11-09 12:32:36
excerpt: 
tags: 最优化算法 KKT条件 不等式约束
rating: ⭐
status: complete 
destination: 03-05 
share: false
obsidianUIMode: source
---
### 问题描述&相关定义
本章考虑的一般形式的优化问题:
$$
\begin{aligned}
\operatorname{minimize} & f(\boldsymbol{x}) \\
\text { subject to } & \boldsymbol{h}(\boldsymbol{x})=\mathbf{0} \\
& \boldsymbol{g}(\boldsymbol{x}) \leqslant \mathbf{0}
\end{aligned}
$$
其中, $f: \mathbb{R}^n \rightarrow \mathbb{R}, \boldsymbol{h}: \mathbb{R}^n \rightarrow \mathbb{R}^m, m \leqslant n, \boldsymbol{g}: \mathbb{R}^n \rightarrow \mathbb{R}^p$ 。

对于一个不等式约束 $g_j(\boldsymbol{x}) \leqslant 0$, 如果在 $\boldsymbol{x}^*$ 处 $g_j\left(\boldsymbol{x}^*\right)=0$, 那么称该不等式约束是 $\boldsymbol{x}^*$ 处的**起作用的约束**; 如果在 $\boldsymbol{x}^*$ 处 $g_j\left(\boldsymbol{x}^*\right)<0$, 那么称该约束是 $\boldsymbol{x}^*$ 处的**不起作用的约束**。等式约束 $h_i(\boldsymbol{x})=0$ 当作总是起作用的约束。

我们定义可行集下的**正则点**：
设 $\boldsymbol{x}^*$ 满足 $\boldsymbol{h}\left(\boldsymbol{x}^*\right)=\mathbf{0}, \boldsymbol{g}\left(\boldsymbol{x}^*\right) \leqslant \mathbf{0}$, 设 $J\left(\boldsymbol{x}^*\right)$ 为起作用不等式约束的下标集:
$$
J\left(\boldsymbol{x}^*\right) \triangleq\left\{j: g_j\left(\boldsymbol{x}^*\right)=0\right\}
$$
如果向量
$$
\nabla h_i\left(\boldsymbol{x}^*\right), \quad \nabla g_j\left(\boldsymbol{x}^*\right), \quad 1 \leqslant i \leqslant m, \quad j \in J\left(\boldsymbol{x}^*\right)
$$
是线性无关的，则称 $\boldsymbol{x}^*$ 是一个**正则点**。

定义如下矩阵为**高阶拉格朗日函数**:
$$
\boldsymbol{L}(\boldsymbol{x}, \boldsymbol{\lambda}, \boldsymbol{\mu})=\boldsymbol{F}(\boldsymbol{x})+[\boldsymbol{\lambda} \boldsymbol{H}(\boldsymbol{x})]+[\boldsymbol{\mu} \boldsymbol{G}(\boldsymbol{x})]
$$
其中, $\boldsymbol{F}(\boldsymbol{x})$ 是 $f$ 在点 $\boldsymbol{x}$ 处的黑塞矩阵, $[\boldsymbol{\lambda H}(\boldsymbol{x})]$ 与之前一样, 表示
$$
[\boldsymbol{\lambda} \boldsymbol{H}(\boldsymbol{x})]=\lambda_1 \boldsymbol{H}_1(\boldsymbol{x})+\cdots+\lambda_m \boldsymbol{H}_m(\boldsymbol{x})
$$
类似地, $[\boldsymbol{\mu} \boldsymbol{G}(\boldsymbol{x})]$ 表示
$$
[\boldsymbol{\mu} \boldsymbol{G}(\boldsymbol{x})]=\mu_1 \boldsymbol{G}_1(\boldsymbol{x})+\cdots+\mu_p \boldsymbol{G}_p(\boldsymbol{x})
$$
其中, $\boldsymbol{G}_k(\boldsymbol{x})$ 是 $g_k$ 在 $\boldsymbol{x}$ 处的黑塞矩阵:
$$
\boldsymbol{G}_k(\boldsymbol{x})=\left[\begin{array}{ccc}
\frac{\partial^2 g_k}{\partial x_1^1}(\boldsymbol{x}) & \cdots & \frac{\partial^2 g_k}{\partial x_n \partial x_1}(\boldsymbol{x}) \\
\vdots & & \vdots \\
\frac{\partial^2 g_k}{\partial x_1 \partial x_n}(\boldsymbol{x}) & \cdots & \frac{\partial^2 g_k}{\partial^2 x_n}(\boldsymbol{x})
\end{array}\right]
$$
在接下来的定理中, 用
$$
T\left(\boldsymbol{x}^*\right)=\left\{\boldsymbol{y} \in \mathbb{R}^n: \nabla \boldsymbol{h}\left(\boldsymbol{x}^*\right) \boldsymbol{y}=\mathbf{0}, \nabla g_j\left(\boldsymbol{x}^*\right) \boldsymbol{y}=0, j \in J\left(\boldsymbol{x}^*\right)\right\}
$$
代表由起作用约束所定义曲面的**切线空间**。

---
### KKT条件 
$KKT$ 条件是满足极小点的必要条件。满足：
1. $\mu^* \geqslant 0$;
2. $\nabla \boldsymbol{f}\left(\boldsymbol{x}^*\right)+\boldsymbol{\lambda}^{* \top} \nabla \boldsymbol{h}\left(\boldsymbol{x}^*\right)+\boldsymbol{\mu}^{* \top} \nabla \boldsymbol{g}\left(\boldsymbol{x}^*\right)=\mathbf{0}^{\top}$;
3. $\boldsymbol{\mu}^{* \top} \boldsymbol{g}\left(\boldsymbol{x}^*\right)=0$;
4. $\boldsymbol{h}\left(\boldsymbol{x}^*\right)=\mathbf{0}$;
5. $\boldsymbol{g}\left(\boldsymbol{x}^*\right) \leqslant \mathbf{0}$

> 主要思想就是引入了KKT算子，提出了$\lambda g(x) =0$ 。下面分情况讨论推导过程。
> 1. $\boldsymbol{g}\left(\boldsymbol{x}^*\right) < 0$ 
> 	此时 $\boldsymbol{g}\left(\boldsymbol{x}^*\right)$  不起约束，转换成仅含等式约束的问题，使用**拉格朗日乘数法**解决即可。
> 2. $\boldsymbol{g}\left(\boldsymbol{x}^*\right) =0$
> 	也是转换成仅含等式约束问题，使用**拉格朗日乘数法解决**即可。
> 3. $\boldsymbol{g}\left(\boldsymbol{x}^*\right)>0$
> 此时 $\boldsymbol{x}^*$ 不满足约束，忽略。
> **所以仅需考虑条件 (1), (2) 即可**
> (1). 若 $\boldsymbol{g}\left(\boldsymbol{x}^*\right)=0$ ，引入乘子 $\mu$ ， 并且规定 $\mu \geqslant 0$[^2]
> (2). 若 $\boldsymbol{g}\left(\boldsymbol{x}^*\right)<0$ ，规定 $\mu = 0$ 。
>  综合起来就是 $\boldsymbol{\mu}^{* \top} \boldsymbol{g}\left(\boldsymbol{x}^*\right)=0$ 

---
### 二阶必要条件
1. $\boldsymbol{\mu}^* \geqslant \mathbf{0}, \nabla f\left(\boldsymbol{x}^*\right)+\boldsymbol{\lambda}^{* \top} \nabla \boldsymbol{h}\left(\boldsymbol{x}^*\right)+\boldsymbol{\mu}^{* \top} \nabla \boldsymbol{g}\left(\boldsymbol{x}^*\right)=\mathbf{0}^{\top}, \boldsymbol{\mu}^{* \top} \boldsymbol{g}\left(\boldsymbol{x}^*\right)=0$;
2. 对于所有 $\boldsymbol{y} \in T\left(\boldsymbol{x}^*\right)$, 都有 $\boldsymbol{y}^{\top} \boldsymbol{L}\left(\boldsymbol{x}^*, \boldsymbol{\lambda}^*, \boldsymbol{\mu}^*\right) \boldsymbol{y} \geqslant 0$ 成立。
---
### 二阶充分条件
1. $\boldsymbol{\mu}^* \geqslant \mathbf{0}, \nabla f\left(\boldsymbol{x}^*\right)+\boldsymbol{\lambda}^{* \top} \nabla \boldsymbol{h}\left(\boldsymbol{x}^*\right)+\boldsymbol{\mu}^{* \top} \nabla \boldsymbol{g}\left(\boldsymbol{x}^*\right)=\mathbf{0}^{\top}, \boldsymbol{\mu}^{* \top} \boldsymbol{g}\left(\boldsymbol{x}^*\right)=0$;
2. 对于所有 $\boldsymbol{y} \in \widetilde{T}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right), \boldsymbol{y} \neq \mathbf{0}$, 都有 $\boldsymbol{y}^{\top} \boldsymbol{L}\left(\boldsymbol{x}^*, \boldsymbol{\lambda}^*, \boldsymbol{\mu}^*\right) \boldsymbol{y}>0$ 。
其中：$\tilde{T}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)$ 定义为：
$$
\tilde{T}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)=\left\{\boldsymbol{y}: D \boldsymbol{h}\left(\boldsymbol{x}^*\right) \boldsymbol{y}=\mathbf{0}, D g_i\left(\boldsymbol{x}^*\right) \boldsymbol{y}=0, i \in \tilde{J}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)\right\}
$$
其中, $\tilde{J}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)=\left\{i: g_i\left(\boldsymbol{x}^*\right)=0, u_i^*>0\right\}$ 。注意 $\tilde{J}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)$ 是 $J\left(\boldsymbol{x}^*\right)$ 的子集, $\widetilde{J}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right) \subset J\left(\boldsymbol{x}^*\right)$ 成立。这意味着, $T\left(\boldsymbol{x}^*\right)$ 是 $\widetilde{T}\left(\boldsymbol{x}^*, \boldsymbol{\mu}^*\right)$ 的子集。

---
### 参考资料
[^1]: Edwin K. P. Chong 等著，孙志强等译；《最优化导论 (第四版》2015.
[^2]: [# KKT条件，原来如此简单 | 理论+算例实践](https://zhuanlan.zhihu.com/p/556832103)
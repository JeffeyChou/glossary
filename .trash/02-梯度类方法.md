---
title: 02-梯度类方法
date: 2022-10-11 09:13:11
excerpt: 
tags: 最优化方法 梯度搜索
rating: ⭐
status: complete 
destination: 03-05
share: false
obsidianUIMode: source
---
### 问题
minimize $f(\boldsymbol{x}) \quad$ 其中, 函数 $f: \mathbb{R}^n \rightarrow \mathbb{R}$ 是一个实值函数。 $\Omega=\mathbb{R}^n$ 
subject to $\boldsymbol{x} \in \Omega$
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"
    src="https://i.imgur.com/r05qQWI.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">函数梯度迭代示意图
    </div>
</center>

### 梯度方法
- **思想**：令$x^0$作为初始搜索点，沿着梯度负方向构造一个新点$x^0-\alpha\bigtriangledown f(x^0)$，如果$\bigtriangledown f(x^0)\neq0$，那么$\alpha >0$足够小时，有$f(x^0-\alpha\bigtriangledown f(x^0))<f(x^0)$.
- **迭代公式**：$x^{k+1}=x^k-\alpha_k\bigtriangledown f(x^k)$.
- **最速下降法**：选择合适的步长$\alpha_k$，使得目标函数能够得到最大程度的减小。
$$
\alpha_k = {arg \ min}_{a \ge 0}\ \  f(x^k-\alpha \bigtriangledown f(x^k))
$$

****
### 最速下降法 
- **定理**： 最速下降法搜索函数 $f: \mathbb{R}^2 \rightarrow \mathbb{R}$ 的极小点, 迭代过程产生的序列为 $\left\{\boldsymbol{x}^{(k)}\right\}_{k=0}^{\infty}$, 那么, $\boldsymbol{x}^{(k+1)}-\boldsymbol{x}^{(k)}$ 与 $\boldsymbol{x}^{(k+2)}-\boldsymbol{x}^{(k+1)}$ 正交对于所有的 $k \geqslant 0$ 都成立。
- **下降性质**：利用梯度的本质，只要$\bigtriangledown f(x^k) \neq 0$，就能保证每次迭代得到的新数值比原数值小。
- 实际计算中的停止搜索准则：定义最小变化量。
		一阶必要条件: $\left\|\nabla f\left(\boldsymbol{x}^{(k)}\right)\right\|<\varepsilon$

#### 最速下降法例题
最速下降法求 $f\left(x_1, x_2, x_3\right)=\left(x_1-4\right)^4+\left(x_2-3\right)^2+4\left(x_3+5\right)^4$ 的极小点。初始搜索点为 $\boldsymbol{x}^{(0)}=[4,2-1]^{\top}$, 开展 3 次迭代。
- Step1:
$$
\begin{aligned}
\alpha_0 &=\underset{\alpha \geqslant 0}{\arg \min } f\left(\boldsymbol{x}^{(0)}-\alpha \nabla f\left(\boldsymbol{x}^{(0)}\right)\right) \\
&=\underset{\alpha \geqslant 0}{\arg \min }\left(0+(2+2 \alpha-3)^2+4(-1-1024 \alpha+5)^4\right)=3.967 \times 10^{-3} \\
\boldsymbol{x}^{(1)} &=\boldsymbol{x}^{(0)}-\alpha_0 \nabla f\left(\boldsymbol{x}^{(0)}\right)=[4.000,2.008,-5.062]^{\top}
\end{aligned}
$$
Step2: $\quad \alpha_1=\underset{\alpha \geqslant 0}{\arg \min }\left(0+(2.008+1.984 \alpha-3)^2+4(-5.062+0.003875 \alpha+5)^4\right)=0.5000$ $\boldsymbol{x}^{(2)}=\boldsymbol{x}^{(1)}-\alpha_1 \nabla f\left(\boldsymbol{x}^{(1)}\right)=[4.000,3.000,-5.060]^{\top}$
Step3: $\quad \alpha_2=\underset{\alpha \geqslant 0}{\arg \min }\left(0.000+0.000+4(-5.060+0.003525 \alpha+5)^4\right)=16.29$ $\boldsymbol{x}^{(3)}=[4.000,3.000,-5.002]^{\top}$
理论上：函数 $f$ 的极小点就是 $[4,3,-5]^{\top}$

#### 梯度方法特性以及收敛性分析
- **特性**：
单调下降算法；全局收敛
- **收敛性分析**：
将目标函数设定为二次函数：
$$
\begin{align}
V(\boldsymbol{x})=f(\boldsymbol{x})+\frac{1}{2} \boldsymbol{x}^{* \top} \boldsymbol{Q} \boldsymbol{x}^*&=\frac{1}{2}\left(\boldsymbol{x}-\boldsymbol{x}^*\right)^{\top} \boldsymbol{Q}\left(\boldsymbol{x}-\boldsymbol{x}^*\right) \\
\bigtriangledown f(x) &= Qx-b
\end{align}
$$

其中, $\boldsymbol{Q}=\boldsymbol{Q}^{\top}>0$  $\quad \boldsymbol{x}^*=\boldsymbol{Q}^{-1} \boldsymbol{b}$

  - **瑞利不等式**：对于任意的 $\boldsymbol{Q}=\boldsymbol{Q}^{\top}>0$, 有
$$
\begin{gathered}
\lambda_{\min }(\boldsymbol{Q})\|\boldsymbol{x}\|^2 \leqslant \boldsymbol{x}^{\top} \boldsymbol{Q} \boldsymbol{x} \leqslant \lambda_{\max }(\boldsymbol{Q})\|\boldsymbol{x}\|^2  \\
\lambda_{\min }\left(\boldsymbol{Q}^{-1}\right)\|\boldsymbol{x}\|^2 \leqslant \boldsymbol{x}^{\top} \boldsymbol{Q}^{-1} \boldsymbol{x} \leqslant \lambda_{\max }\left(\boldsymbol{Q}^{-1}\right)\|\boldsymbol{x}\|^2
\end{gathered}
$$
  - **收敛性**:
对于最速下降法，对于任意的初始点 $\boldsymbol{x}^{(0)}$ ,都有 $\boldsymbol{x}^{(k)} \rightarrow \boldsymbol{x}^*$ 。

#### 固定步长梯度法
对于所有步长 $\alpha_{k}=\alpha \in \mathbb{R}$,迭代公式为：$\boldsymbol{x}^{(k+1)}=\boldsymbol{x}^{(k)}-\alpha \boldsymbol{g}^{(k)}$
- **定理8.3**:
对于步长固定梯度法, 当且仅当步长
$$
0<\alpha<\frac{2}{\lambda_{\max }(\boldsymbol{Q})}
$$
时, $\boldsymbol{x}^{(k)} \rightarrow \boldsymbol{x}^*$ 。

---
#### 收敛率
- **定义8.1(收敛阶)**:
存在一个序列 $\left\{\boldsymbol{x}^{(k)}\right\}$, 能够收敛到 $\boldsymbol{x}^*$, 即 $\lim _{k \rightarrow \infty}\left\|\boldsymbol{x}^{(k)}-\boldsymbol{x}^*\right\|=0$ 。 如果
$$
0<\lim _{k \rightarrow \infty} \frac{\|\boldsymbol{x}^{(k+1)}-\boldsymbol{x}^*\|}{\|\boldsymbol{x}^{(k)}-\boldsymbol{x}^*\|^p}<\infty
$$
则序列 $\left\{\boldsymbol{x}^{(k)}\right\}$ 的收敛阶数为 $p$, 其中, $p \in \mathbb{R}_{\text {。 }}$
如果对任意的 $p>0$ ，上式极限都为 $0$ ，那么称收敛阶数为 $\infty$ 。

- **定理8.6**：
 最速下降法在求解目标函数 $f$ 的极小点时,产生一个收敛的迭代点 $\left\{\boldsymbol{x}^{(k)}\right\}$, 该序列在最坏情况下的收敛阶数为 1 。也就是说, 存在一个目标函数 $f$ 和某 始点 $\boldsymbol{x}^{(0)}$, 能够使得 $\left\{\boldsymbol{x}^{(k)}\right\}$ 的收敛阶数为 1 。
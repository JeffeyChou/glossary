---
date: 2023-04-23 12:50:35
categories: Homework 
destination: 
excerpt: 
katex: true
obsidianUIMode: source
rating: ⭐⭐
tags:  
- 作业
title: "数值分析第六次作业-幂求法"
share: false
---

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"
    src="https://search.pstatic.net/common?src=https://i.imgur.com/iufDQYq.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">作业截图
    </div>
</center>

# 1
1. 可以求为`7`的特征值，幂法用于求模最大的特征值及对应特征向量
    - 幂法的线性收敛率为 $S \leqslant |\frac{\lambda_{2}}{\lambda_{1}}|=\frac{6}{7}$
2. 可以求为`-3`和`5`的特征值，位移逆幂法用于求离 $\mu$最近的特征值及对应特征向量
    - 逆幂法的线性收敛率 $S \leqslant | \frac{\lambda_{n}}{\lambda_{n-1}} |$, 那么对应的位移逆幂法的收敛率就是离 $\mu=4$ 最小的两个`相对`特征值的比值： $\frac{1}{2}$
综上，第一种使用幂迭代的方法收敛更快。


# 2
首先对矩阵进行[[Gram-Schmidt]]正交化：
$$\begin{align*}
v_{1}&=\begin{pmatrix}-2/3 & -1/3 & 	2/3\end{pmatrix}\\
v_{2}&=\begin{pmatrix}-2/3 & 2/3 & 	-1/3\end{pmatrix}\\
\\
\end{align*}$$


计算$\mathbf{Q}^T\mathbf{A}$：

$$
\mathbf{Q}^T\mathbf{A} = \begin{pmatrix}-2/3 & -1/3 & 2/3 \\ -2/3 & 2/3 & -1/3\end{pmatrix}\begin{pmatrix}-4 & -4 \\ -2 & 7 \\ 4 & -5\end{pmatrix} = \begin{pmatrix}6 & -3  \\ 0 & 	9\end{pmatrix} = \mathbf{R}
$$

因此，矩阵$\mathbf{A}$的QR分解为：

$$
\mathbf{A} = \mathbf{Q}\mathbf{R} = \begin{pmatrix} 
-2/3 & -2/3  \\ 2/3 & -1/3 \\ -1/3 & 2/3 \end{pmatrix}\cdot\begin{pmatrix}6 & -3 \\ 0 & 	9\end{pmatrix}
$$

# 3

```Mathematica
A = {{8, -8, -4}, {12, -15, -7}, {-18, 26, 12}}; (*define a matrix*)
x0 = {1, 1, 1}; (*initial guess for eigenvector*)
tol = 10^-6; (*tolerance for convergence*)

x = x0;
lambda = 0;
err = 1;
epoach = 12;
iter = 0

While[iter < epoach, x = A . x;
 lambda = Max[Abs[x]];
 x = x/lambda;
 err = Max[Abs[x - x0]];
 x0 = x; Print["Eigenvalue: ", lambda];
 Print["Eigenvector: ", x];
 iter += 1;]
```

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"
    src="https://search.pstatic.net/common?src=https://i.imgur.com/wtZZpux.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">迭代输出结果
    </div>
</center>

```Mathematica
InversePowerIteration[A_, x0_, sigma_, n_] := 
  Module[{x = x0}, 
   Do[ B = Inverse[A - sigma IdentityMatrix[Length[A]]];
    
    x = B . x/Max[Abs[B . x]];
    
    lambda = x . A . x/Max[Abs[x]];
    Print["Iteration ", i, ": Eigenvalue = ", lambda, 
     ", Eigenvector = ", x];
    , {i, 1, n}];
   {lambda, x}];
A = {{8, -8, -4}, {12, -15, -7}, {-18, 26, 12}}; 
x0 = {1, 1, 1};
n = 12;
InversePowerIteration[A, x0, 0, n]
```

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"
    src="https://search.pstatic.net/common?src=https://i.imgur.com/pmhfOed.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">程序运行结果
    </div>
</center>

# 4
```Python
import numpy as np

# QR分解函数


def qr_decomposition(A):
    Q, R = np.linalg.qr(A)
    return R.dot(Q), Q

# QR迭代函数


def qr_iteration(A, max_iterations=1000, tolerance=1e-6):
    n = A.shape[0]
    Q = np.eye(n)
    for i in range(max_iterations):
        A_new, Q_new = qr_decomposition(A)
        A = A_new
        Q = Q.dot(Q_new)
        # 判断是否收敛
        off_diag = np.abs(np.triu(A, k=1)).max()
        if off_diag < tolerance:
            print(f'stop at iteration {i}')
            break
    # 提取特征值和特征向量
    eigenvalues = np.diag(A)
    eigenvectors = Q.T
    return eigenvalues, eigenvectors


# Example usage
def main():
    A = np.array([[8, -8, -4],
              [12, -15, -7],
              [-18, 26, 12]])
    eigenvalues, eigenvectors = qr_iteration(A, 25, 1e-12)
    print("特征值：", eigenvalues)
    print("特征向量：", eigenvectors)


if __name__ == "__main__":
    main()

```

<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);"
    src="https://search.pstatic.net/common?src=https://i.imgur.com/LXZ4BAg.png">
    <br>
    <div style="color:orange; border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;">程序运行结果
    </div>
</center>

